package com.weidi.listener;

import org.jivesoftware.smack.PacketListener;
import org.jivesoftware.smack.packet.Packet;

import android.content.Intent;

import com.weidi.QApp;
import com.weidi.chat.groupchat.CreatChatRoomActivity;
import com.weidi.provider.CreateMUCIQ;
import com.weidi.util.Logger;

/**
 *@author  luochangdong  E-mail: 2270333671@qq.com
 *@date 创建时间：2015-7-8 下午6:36:20
 *@Description 1.0
 */
public class XmppIQListener implements PacketListener {

	private static String TAG = "XmppIQListener";
	public static final String MUC = "muc";
	@Override
	public void processPacket(Packet packet) {
		Logger.i(TAG, packet.toXML());
		String xml = packet.toXML();
		if(xml.contains("event=\"getgroupinfo\"")){
			CreateMUCIQ iq = (CreateMUCIQ) packet;
			Intent intent = new Intent(CreatChatRoomActivity.ADD_GROUP_MENBER);
			if(iq.getMuc() != null)
			intent.putExtra(MUC, iq.getMuc());
			Logger.i(TAG, iq.getMuc());
			QApp.mLocalBroadcastManager.sendBroadcast(intent);
		}
		
	}

}
